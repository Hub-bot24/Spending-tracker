
<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Spending ‚Äî Monthly Subtractor</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0ea5e9">
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js').catch(console.error);
  }
</script>

<style>
  /* ===== Theme ===== */
  :root{
    --bg: #f8fafc;           /* page background */
    --card: #ffffff;         /* cards */
    --bd: #e5e7eb;           /* borders */
    --text: #0f172a;         /* primary text (slate-900) */
    --muted:#6b7280;         /* slate-500 */
    --accent:#0ea5e9;        /* sky-500 */
    --accent-2:#6366f1;      /* indigo-500 */
    --ok:#065f46;            /* emerald-900 */
    --warn:#b91c1c;          /* red-700 */
  }

  /* Subtle gradient background */
  body{
    margin:0;
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,"Apple Color Emoji","Segoe UI Emoji";
    color:var(--text);
    background:
      radial-gradient(1200px 600px at -10% -20%, #e0f2fe 0%, transparent 60%),
      radial-gradient(1000px 500px at 110% -10%, #e9d5ff 0%, transparent 55%),
      var(--bg);
  }

  .wrap{ max-width:920px; margin:28px auto 110px; padding:0 20px; }

  /* Header */
  .hero{
    display:flex; align-items:center; gap:14px; margin:2px 0 10px;
  }
  .badge{
    background:linear-gradient(135deg,var(--accent),var(--accent-2));
    color:#fff; font-weight:800; padding:8px 14px; border-radius:14px;
    box-shadow:0 6px 16px rgba(14,165,233,.25);
  }
  h1{
    margin:0; letter-spacing:.2px;
    font-size:clamp(24px,3.4vw,34px); font-weight:900;
    background:linear-gradient(135deg,#0f172a 20%, #334155 40%, var(--accent) 70%, var(--accent-2));
    -webkit-background-clip:text; background-clip:text; color:transparent;
  }
  p.muted{color:var(--muted); margin-top:6px}

  /* Cards */
  .card{
    background:var(--card); border:1px solid var(--bd);
    border-radius:20px; padding:18px 18px 14px; margin:14px 0;
    box-shadow:0 8px 22px rgba(2,6,23,.06);
  }

  label{display:block; margin:.55rem 0 .3rem; font-weight:700}
  input{
    width:100%; padding:.75rem .9rem; border:1px solid var(--bd); border-radius:14px;
    font-size:16px; transition:.15s border, .15s box-shadow;
    background:#fff;
  }
  input:focus{ outline:none; border-color:var(--accent);
    box-shadow:0 0 0 3px rgba(14,165,233,.2) }

  .row{display:grid; grid-template-columns:1fr 160px 130px; gap:12px; align-items:end}

  .btn{
    background:linear-gradient(135deg,var(--accent),var(--accent-2));
    color:#fff; border:0; border-radius:14px; padding:.7rem .95rem; cursor:pointer;
    font-weight:800; letter-spacing:.2px; box-shadow:0 6px 14px rgba(14,165,233,.35);
    transition:transform .08s ease;
  }
  .btn:hover{ transform:translateY(-1px) }
  .btn.secondary{
    background:#fff; color:var(--text); border:1px solid var(--bd);
    box-shadow:none; font-weight:700;
  }
  .btn.small{ padding:.5rem .7rem; border-radius:12px }

  /* Table */
  table{width:100%; border-collapse:separate; border-spacing:0; margin-top:10px}
  th,td{ padding:12px 10px; text-align:left; border-bottom:1px solid var(--bd) }
  th{ font-size:13px; color:var(--muted); text-transform:uppercase; letter-spacing:.3px }
  tbody tr:nth-child(odd){ background:#fcfcfd }
  td:last-child{ text-align:right }

  /* Totals / progress */
  .stats{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px }
  .pill{
    background:var(--card); border:1px solid var(--bd);
    border-radius:16px; padding:14px 14px 12px; display:flex; flex-direction:column; gap:8px;
  }
  .pill .t{ font-size:12px; color:var(--muted); font-weight:700; text-transform:uppercase; letter-spacing:.4px }
  .pill .v{ font-size:20px; font-weight:900 }

  .progress{ height:10px; background:#eef2ff; border-radius:999px; overflow:hidden }
  .bar{ height:100%; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent-2)); transition:width .25s ease }

  .right{ display:flex; gap:8px; justify-content:flex-end; flex-wrap:wrap; margin-top:10px }
  .ok{ color:var(--ok) } .danger{ color:var(--warn) }

  /* Bottom tabs */
  .tabbar{
    position:fixed; left:0; right:0; bottom:0; z-index:9999;
    display:flex; background:#ffffffb3; backdrop-filter:blur(8px);
    border-top:1px solid var(--bd);
  }
  .tabbar a{
    flex:1; text-align:center; padding:14px 10px; text-decoration:none;
    color:#334155; font-weight:800;
  }
  .tabbar a span{ display:block; font-size:11px; letter-spacing:.3px; text-transform:uppercase; color:var(--muted) }
  .tabbar a.active{ color:var(--accent-2) }
  .wrap{ margin-bottom:92px }
</style>

<body>
  <div class="wrap">
    <div class="hero">
      <div class="badge">üí∏ Spending</div>
      <h1>Monthly Subtractor</h1>
    </div>
    <p class="muted">Enter your monthly budget at the top, then add expenses below. Works offline; data stays on this device.</p>

    <div class="card">
      <label for="budget">Monthly spending budget (AUD)</label>
      <input id="budget" type="number" min="0" step="0.01" placeholder="e.g. 1200">
      <div class="right">
        <button class="btn small secondary" id="reset">Reset month</button>
        <button class="btn small secondary" id="copy">Copy summary</button>
      </div>
    </div>

    <div class="card">
      <div class="row">
        <div>
          <label for="desc">Entry</label>
          <input id="desc" placeholder="e.g. Groceries">
        </div>
        <div>
          <label for="amt">Amount (AUD)</label>
          <input id="amt" type="number" step="0.01" min="0" placeholder="e.g. 75.50">
        </div>
        <button class="btn" id="add">Add</button>
      </div>

      <table>
        <thead><tr><th>Date</th><th>Entry</th><th>Amount</th></tr></thead>
        <tbody id="rows"><tr><td colspan="3" class="muted">No entries yet.</td></tr></tbody>
      </table>
    </div>

    <div class="stats">
      <div class="pill"><span class="t">Budget (month)</span><span class="v" id="tBudget">$0</span></div>
      <div class="pill"><span class="t">Spent</span><span class="v" id="tSpent">$0</span></div>
      <div class="pill">
        <span class="t">Remaining</span><span class="v" id="tRemain">$0</span>
        <div class="progress"><div id="bar" class="bar"></div></div>
        <span class="t" id="pctText">0% left</span>
      </div>
    </div>
  </div>

  <!-- Bottom tabs -->
  <nav class="tabbar" role="navigation" aria-label="Bottom tabs">
    <a href="/Spending-tracker/" data-tab="spending" class="active">üí∏<span>Spending</span></a>
    <a href="/Spending-tracker/food/" data-tab="food">üçî<span>Food</span></a>
  </nav>

<script>
  const fmt = v => new Intl.NumberFormat('en-AU',{style:'currency',currency:'AUD'}).format(Number(v||0));
  const today = () => new Date().toISOString().slice(0,10);

  const KEY="spend.monthly.v1";
  const state = JSON.parse(localStorage.getItem(KEY) || '{"budget":0,"items":[]}');

  const el = (id)=>document.getElementById(id);
  const budget = el('budget'), rows = el('rows'), tBudget = el('tBudget'), tSpent = el('tSpent'), tRemain = el('tRemain');
  const bar = el('bar'), pctText = el('pctText'); const desc = el('desc'), amt = el('amt');

  function render(){
    const spent = state.items.reduce((s,i)=>s+Number(i.amount||0),0);
    const b = Number(state.budget||0);
    const remain = b - spent;

    rows.innerHTML = state.items.length
      ? state.items.map((i,idx)=>`
        <tr>
          <td>${i.date}</td>
          <td>${i.desc}</td>
          <td>${fmt(i.amount)}
            <button class="btn small secondary" onclick="del(${idx})" title="Remove">‚úï</button>
          </td>
        </tr>`).join('')
      : `<tr><td colspan="3" class="muted">No entries yet.</td></tr>`;

    tBudget.textContent = fmt(b);
    tSpent.textContent = fmt(spent);
    tRemain.textContent = fmt(remain);

    // progress bar
    const pct = b>0 ? Math.max(0, Math.min(100, Math.round((remain/b)*100))) : 0;
    bar.style.width = (100 - pct) + '%';           // fill used part
    pctText.textContent = `${pct}% left`;
    tRemain.classList.toggle('danger', remain < 0);
    tRemain.classList.toggle('ok', remain >= 0);

    budget.value = b || '';
    localStorage.setItem(KEY, JSON.stringify(state));
  }

  function add(){
    const d = (desc.value||'').trim();
    const a = Number(amt.value||0);
    if (!d || !(a>0)) return;
    state.items.unshift({date: today(), desc: d, amount: a});
    desc.value=''; amt.value='';
    render();
  }
  function del(idx){ state.items.splice(idx,1); render(); }
  function setBudget(){ state.budget = Number(budget.value||0); render(); }
  function resetAll(){
    if (!confirm('Reset this month? This clears entries and budget.')) return;
    state.budget = 0; state.items = []; render();
  }
  function copySummary(){
    const spent = state.items.reduce((s,i)=>s+Number(i.amount||0),0);
    const remain = (Number(state.budget||0) - spent);
    const lines = [
      `Spending (Monthly)`,
      `Budget: ${fmt(state.budget)}`,
      `Spent:  ${fmt(spent)}`,
      `Remaining: ${fmt(remain)}`,
      ``,
      `Entries:`,
      ...(state.items.length ? state.items.map(i=>`- ${i.date} ¬∑ ${i.desc}: ${fmt(i.amount)}`) : ['(none)'])
    ].join('\n');
    navigator.clipboard.writeText(lines).then(()=>alert('Summary copied.'));
  }

  window.del = del;
  document.getElementById('add').addEventListener('click', add);
  document.getElementById('reset').addEventListener('click', resetAll);
  document.getElementById('copy').addEventListener('click', copySummary);
  budget.addEventListener('change', setBudget);
  budget.addEventListener('keyup', e=>{ if(e.key==='Enter') setBudget(); });

  render();
</script>
</body>
</html>
